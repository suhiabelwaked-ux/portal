from marshmallow import Schema, fields, validate

class VulnerabilitySchema(Schema):
    id = fields.Int()
    name = fields.Str()
    severity = fields.Str()
    created_at = fields.DateTime()

class PendingVulnerabilitySchema(Schema):
    id = fields.Int()
    name = fields.Str()
    severity = fields.Str()
    search_type = fields.Str()
    submitted_by = fields.Str()
    created_at = fields.DateTime()

class CreatePendingVulnerabilitySchema(Schema):
    name = fields.Str(required=True, validate=validate.Length(min=1))
    severity = fields.Str(required=True, validate=validate.OneOf(['high', 'medium', 'low', 'informational']))
    search_type = fields.Str(required=True, validate=validate.OneOf(['router', 'firewall']))

class VulnerabilityLookupSchema(Schema):
    name = fields.Str(required=True, validate=validate.Length(min=1))